---
# User Assistance MCP API - Customer Support Profile
apiVersion: hub.traefik.io/v1alpha1
kind: API
metadata:
  name: user-assistance-api
  namespace: airlines
  labels:
    {{- include "airlines.labels" . | nindent 4 }}
    component: mcp
    profile: user-assistance
spec:
  title: "User Assistance MCP"
  description: "Customer Support & Disruption Management - MCP tools for handling customer issues, flight disruptions, and support requests"
---
# Ticketing Agent MCP API - Sales & Operations Profile
apiVersion: hub.traefik.io/v1alpha1
kind: API
metadata:
  name: ticketing-agent-api
  namespace: airlines
  labels:
    {{- include "airlines.labels" . | nindent 4 }}
    component: mcp
    profile: ticketing-agent
spec:
  title: "Ticketing Agent MCP"
  description: "Sales & Ticketing Operations - MCP tools for booking, ticketing, check-in, and passenger services"
---
# Partner Assistance MCP API - B2B Operations Profile
apiVersion: hub.traefik.io/v1alpha1
kind: API
metadata:
  name: partner-assistance-api
  namespace: airlines
  labels:
    {{- include "airlines.labels" . | nindent 4 }}
    component: mcp
    profile: partner-assistance
spec:
  title: "Partner Assistance MCP"
  description: "B2B & Alliance Operations - MCP tools for managing partner airlines, codeshares, and alliance operations"
---
# MCP Middleware for User Assistance
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: user-assistance-mcp
  namespace: airlines
  labels:
    {{- include "airlines.labels" . | nindent 4 }}
    component: mcp
    profile: user-assistance
spec:
  plugin:
    mcp:
      listPolicies:
        - match: Equals(`mcp.params.name`, `ping`)
          action: show
        - match: Prefix(`mcp.params.name`, `flight_`)
          action: show
        - match: Prefix(`mcp.params.name`, `booking_get_`) || Prefix(`mcp.params.name`, `booking_search_`)
          action: show
        - match: Prefix(`mcp.params.name`, `passenger_`)
          action: show
        - match: Prefix(`mcp.params.name`, `baggage_track`) || Prefix(`mcp.params.name`, `baggage_report_`)
          action: show
        - match: Prefix(`mcp.params.name`, `loyalty_get_profile`) || Prefix(`mcp.params.name`, `loyalty_add_`)
          action: show
        - match: Prefix(`mcp.params.name`, `compensation_`)
          action: show
        - match: Prefix(`mcp.params.name`, `notification_`)
          action: show
      listDefaultAction: hide
---
# MCP Middleware for Ticketing Agent
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: ticketing-agent-mcp
  namespace: airlines
  labels:
    {{- include "airlines.labels" . | nindent 4 }}
    component: mcp
    profile: ticketing-agent
spec:
  plugin:
    mcp:
      listPolicies:
        - match: Equals(`mcp.params.name`, `ping`)
          action: show
        - match: Prefix(`mcp.params.name`, `flight_search`) || Prefix(`mcp.params.name`, `flight_get_pricing`)
          action: show
        - match: Prefix(`mcp.params.name`, `booking_create`) || Prefix(`mcp.params.name`, `booking_modify`) || Prefix(`mcp.params.name`, `booking_cancel`)
          action: show
        - match: Prefix(`mcp.params.name`, `checkin_`)
          action: show
        - match: Prefix(`mcp.params.name`, `seat_`)
          action: show
        - match: Prefix(`mcp.params.name`, `ancillary_`)
          action: show
        - match: Prefix(`mcp.params.name`, `baggage_manage`)
          action: show
        - match: Prefix(`mcp.params.name`, `loyalty_get_status`) || Prefix(`mcp.params.name`, `loyalty_redeem_`) || Prefix(`mcp.params.name`, `loyalty_transfer_`)
          action: show
      listDefaultAction: hide
      description: "Ticketing and sales tools for booking, modifications, and passenger services"
---
# MCP Middleware for Partner Assistance
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: partner-assistance-mcp
  namespace: airlines
  labels:
    {{- include "airlines.labels" . | nindent 4 }}
    component: mcp
    profile: partner-assistance
spec:
  plugin:
    mcp:
      listPolicies:
        - match: Equals(`mcp.params.name`, `ping`)
          action: hide
        # - match: Prefix(`mcp.params.name`, `partner_`)
        #   action: show
        # - match: Prefix(`mcp.params.name`, `booking_create_alliance`)
        #   action: show
      listDefaultAction: show
---
# IngressRoute for User Assistance MCP
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: user-assistance-mcp-route
  namespace: airlines
  labels:
    {{- include "airlines.labels" . | nindent 4 }}
    component: mcp
    profile: user-assistance
  annotations:
    hub.traefik.io/api: user-assistance-api
spec:
  entryPoints:
    {{- range .Values.entryPoints }}
    - {{ . }}
    {{- end }}
  routes:
    - kind: Rule
      match: Host(`user-assistance.{{ .Values.domain }}`)
      services:
        - name: airlines-mcp
          port: 8080
      middlewares:
        - name: user-assistance-mcp
---
# IngressRoute for Ticketing Agent MCP
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: ticketing-agent-mcp-route
  namespace: airlines
  labels:
    {{- include "airlines.labels" . | nindent 4 }}
    component: mcp
    profile: ticketing-agent
  annotations:
    hub.traefik.io/api: ticketing-agent-api
spec:
  entryPoints:
    {{- range .Values.entryPoints }}
    - {{ . }}
    {{- end }}
  routes:
    - kind: Rule
      match: Host(`ticketing-agent.{{ .Values.domain }}`)
      services:
        - name: airlines-mcp
          port: 8080
      middlewares:
        - name: ticketing-agent-mcp
---
# IngressRoute for Partner Assistance MCP
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: partner-assistance-mcp-route
  namespace: airlines
  labels:
    {{- include "airlines.labels" . | nindent 4 }}
    component: mcp
    profile: partner-assistance
  annotations:
    hub.traefik.io/api: partner-assistance-api
spec:
  entryPoints:
    {{- range .Values.entryPoints }}
    - {{ . }}
    {{- end }}
  routes:
    - kind: Rule
      match: Host(`partner-assistance.{{ .Values.domain }}`)
      services:
        - name: airlines-mcp
          port: 8080
      middlewares:
        - name: partner-assistance-mcp
